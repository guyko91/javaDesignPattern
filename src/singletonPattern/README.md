# Singleton 패턴
* 싱글톤 패턴은 전역변수를 사용하지 않고, **객체를 하나만 생성**하도록 하며, 생성된 객체를 **어디서나 참조할 수 있도록** 하는 패턴.
* *생성(Creational)패턴* 중 하나.
    * *생성 패턴* : 객체 생성에 관련된 패턴. 객체의 생성과 조합을 캡슐화 해 특정 객체가 생성되거나 변경되어도 프로그램에 크게 영향을 미치지 않도록 유연성을 제공한다.

# 예제
## 프린터 관리자 만들기
### As-Is
* 프린트 객체는 한번만 생성되도록 해야 하므로 생성자 메서드를 private로 선언.
* 자기 자신(프린터)에 대한 인스턴스 변수를 하나 생성하고, 외부에 그 객체를 제공할 메서드를 추가.
    * static 변수(printer) 및 static 메서드(getPrinter()) 생성.
        * static 변수 및 메서드는 인스턴스에 속하는 영역이 아닌 클래스 자체에 속한다.
        * 클래스의 인스턴스를 통하지 않고서도 변수를 참조하거나 메서드를 실행할 수 있다.
    * 한번이라도 생성되어야 인스턴스 메서드인 print()를 호출할 수 있다.
### As-Is의 문제점 
* *경합 조건*(Race-Condition)*을 발생시키는 경우. (다중 스레드 환경)
    * Printer는 getPrinter메서드를 통해 인스턴스가 null인지 체크하고, null인 경우 인스턴스를 생성한다.
    * 만약 User 1이 생성자를 호출해서 인스턴스를 만들기 전에 User 2가 getPrinter를 호출하면 인스턴스가 2개가 생성될 수 있다.
    * *경합조건* : 메모리와 같은 동일한 자원을 2개 이상의 스레드가 이용하려고 경합하는 현상.
    
### 해결책
#### 1. 정적 변수에 인스턴스를 만들어 바로 초기화 하는 방법.
* 객체가 생성되기 전 클래스가 메모리에 로딩될 때, 초기화하 한번만 실행된다.
* 프로그램 시작 ~ 종료까지 없어지지 않고 메모리에 상주하며, 클래스에서 생성된 모든 객체에서 참조할 수 있다.
#### 2. 인스턴스를 만드는 메서드에 동기화 하는 방법. 
* 인스턴스를 만드는 메서드를 *임계 구역*으로 변경.
    * *임계구역* : 입출력 및 공유 데이터 등 원자적으로 실행할 필요가 있는 명령문 또는 코드의 일부 영역.
    * 다중 스레드 환경에서 동시에 여러 스레드가 getPrinter() 메서드를 소유하는 객체에 접근하는 것을 방지한다.
        * 여러개의 스레드가 하나뿐인 counter 변수 값에 동시에 접근해 갱신하는 것을 방지한다.
    * getInstance()에 Lock을 하는 방식이라 **속도가 느리다.**
#### 3. 정적 클래스 사용.
* 정적 메서드로만 이루어진 정적 클래스를 사용하면 싱글턴과 동일한 효과를 얻을 수 있다.
    * 정적 클래스를 이용하면 객체를 전혀 생성하지 않고 메서드를 사용한다.
    * 정적 메서드를 사용하므로, 일반적으로 실행할때 바인딩되는 인스턴스 메서드를 사용하는 것 보다 **성능 면에서 우수하다.**
#### 4. Enum 클래스 사용.
* Thread-Safety와 Serialization이 보장된다.
* Reflection을 통한 공격에도 안전하다.
* Enum을 사용하여 Singleton을 구현하는 것이 가장 좋은 방법이다.

### 추가로 알아볼만 한 내용
* volatile
* memory consistency
* 직렬화와 역직렬화